<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>SFU CS UTM Builder</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@400;500;600;700&display=swap" rel="stylesheet">

</head>

<body class="gen">
    <div class="tabs" style="margin-top: 25px">
        <div class="flex-tab" style="background-color: white; padding: 10px 20px;">General</div> 
        <div class="flex-tab" style="background-color: rgb(207, 205, 205);"><a href="/index.html" style="display: block; padding: 10px 20px;">Campaigner &rarr;</a></div>
    </div>
    <div class="container">
        <div class="flex-child">
            <h2>UTM Builder</h2>
            <form id="utmBuilder">
                <label for="program">Select program</label><br>
                <select oninput="getProgram(this)" name="campProgram" id="campProgram">
                    <option value="x">Select program from dropdown</option>
                    <option value="bus+analysis">Business Analysis</option>
                    <option value="business+communication">Business Communication</option>
                    <option value="business+mgt">Business Management</option>
                    <option value="career+practitioner">Career Practitioner</option>
                    <option value="chinese+translation">Chinese Translation</option>
                    <option value="city">City</option>
                    <option value="climate">Climate</option>
                    <option value="communication">Communication</option>
                    <option value="community+building">Community Building</option>
                    <option value="community+data+science">Community Data Science</option>
                    <option value="creative+writing">Creative Writing</option>
                    <option value="cs-wide">CS wide</option>
                    <option value="dialogue">Dialogue</option>
                    <option value="editing">Editing</option>
                    <option value="elc">English Learning Centre</option>
                    <option value="evaluation">Evaluation</option>
                    <option value="executive+leadership">Executive Leadership</option>
                    <option value="first+responders">First Responders</option>
                    <option value="future+skills+grant">Future Skills Grant</option>
                    <option value="hr+management">HR Management</option>
                    <option value="itp">Interpretation and Translation Program</option>
                    <option value="japanese+translation">Japanese Translation</option>
                    <option value="leadership+essentials">Leadership Essentials</option>
                    <option value="legal+itp">Legal Interpretation and Translation Program</option>
                    <option value="liberal-arts">Liberal Arts</option>
                    <option value="liberal-arts+and+55+plus">Liberal Arts and 55 Plus</option>
                    <option value="medical+tip">Medical Translation and Interpretation Program</option>
                    <option value="non-profit+mgt">Non-Profit Management</option>
                    <option value="non-profit+mgt+-+bc">Non-Profit Management BC</option>
                    <option value="non-profit+mgt+-+canada">Non-Profit Management Canada</option>
                    <option value="plain+language">Plain Language</option>
                    <option value="project+mgt">Project Management</option>
                    <option value="public+companies">Public Companies</option>
                    <option value="rehab">Rehabilitation</option>
                    <option value="rj">Restorative Justice</option>
                    <option value="rj+-+bc">Restorative Justice BC</option>
                    <option value="rj+-+canada">Restorative Justice Canada</option>
                    <option value="rj+-+on">Restorative Justice Ontario</option>
                    <option value="rj+-+us">Restorative Justice US</option>
                    <option value="risk+mgt">Risk Management</option>
                    <option value="seniors">Seniors</option>
                    <option value="simultaneous+itp">Simultaneous Interpretation and Translation Program</option>
                    <option value="social+innovation">Social Innovationn</option>
                    <option value="tech+comm">Technical Communication</option>
                    <option value="tech+comm+-+bc">Technical Communication BC</option>
                    <option value="tech+comm+-+canada">Technical Communication Canada</option>
                    <option value="urban+design">Urban Design</option>
                    <option value="vrdm">Vocational Rehabilitation and Disability Management</option>
                </select><br>
                <label for="source">Select Source</label>
                <p class="small-text" style="margin-bottom:0px;">Used to identify a source of delivery.</p>
                <select oninput="getSource(this)" name="campSource" id="campSource">
                    <option value="x">Select source from dropdown</option>
                    <option value="facebook.com">Facebook</option>
                    <option value="linkedin.com">Linkedin</option>
                    <option value="instagram.com">Instagram</option>
                    <option value="twitter.com">X (twitter)</option>
                    <option value="eventbrite.com">Eventbrite</option>
                    <option value="cphr">CPHR eblast</option>
                    <option value="thetyee.ca">The Tyee</option>
                    <option value="sfu-ss">SFU Student Services</option>
                    <option value="newsletter">Newsletter (SFU originated)</option>
                    <option value="INSERT-CUSTOM-SOURCE-HERE">OTHER (manual utm edit required)</option>
                </select>
                <label for="medium">Select Medium</label>
                <p class="small-text" style="margin-bottom:0px;">Used to identify a medium of delivery.</p>
                <select oninput="getMedium(this)" name="campMedium" id="campMedium">
                    <option value="x">Select mediun from dropdown</option>
                    <option value="affiliate">affiliate (delivered by affiliate)</option>
                    <option value="email">email (sent by cs-marketing)</option>
                    <option value="paid">paid (paid ad campaigns only)</option>
                    <option value="social">social (unpaid social media post)</option>

                </select><br>
                <label for="date">Campaigner deployment date</label><br>
                <input oninput="getDate(this)" type="date" id="campDate" name="camp-date" value="date"
                    class="sub-text" /><br>
                <p class="small-text">Click calendar icon to the right for date picker.</p>
                <label for="suject">Campaigner email subject</label><br>
                <input oninput="getSubject(this)" type="text" id="campSubject" name="campSubject" class="sub-text"><br>
                <p class="small-text">No accented vowels. Replace with non-accented equivalent.</p>
                <label for="eblink">Is the URL a Eventbrite affiliate link</label><a
                    href="https://www.eventbrite.com/help/en-us/articles/835126/how-to-create-promotional-tracking-links/"
                    target="_blank"><img src="img/icon-tooltip-questionmark.png" class="tooltip"></a><br>
                <select oninput="getEblink(this)" name="campEb" id="campEb">
                    <option value="Null">Select answer</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
                <label for="url" id="labelUrl">URL to be shared</label><br>
                <textarea oninput="getUrl(this)" id="campUrl" name="campUrl" rows="4" cols="50"></textarea><br><br>
            </form>

            <button onclick="getTracking()">Generate UTM</button>
            <button onclick="getTrackingUrl()">Generate URL & UTM</button>
            <button id="btnClear" type="button" onClick="window.location.reload()">Clear all</button>
        </div>
        <div class="flex-child blue">
            <h2 style="color: white">UTM Output</h2>
            <div class="parent">
                <div class="flex-utm1">URL query check</div>
                <div class="flex-utm2">
                    <p id="utmcampQuery"></p>
                </div>
                <div class="flex-utm1">utm_id=</div>
                <div class="flex-utm2"><img src="img/icon-lock.png" class="lock">
                    <p class="locked">cstudies</p>
                </div>
                <div class="flex-utm1">utm_campaign=</div>
                <div class="flex-utm2">
                    <p id="utmcampProgram"></p>
                </div>
                <div class="flex-utm1">utm_source=</div>
                <div class="flex-utm2">
                    <p id="utmcampSource"></p>
                </div>
                <div class="flex-utm1">utm_medium=</div>
                <div class="flex-utm2">
                    <p id="utmcampMedium"></p>
                </div>
                <div class="flex-utm1">Campaigner deployment date</div>
                <div class="flex-utm2">
                    <p id="utmcampDate"></p>
                </div>
                <div class="flex-utm1">Campaigner email subject</div>
                <div class="flex-utm2">
                    <p id="utmcampSubject"></p>
                </div>
                <div class="flex-utm1">URL anchor check</div>
                <div class="flex-utm2">
                    <p id="utmAnchor"></p>
                </div>
            </div>
            <br><br>
            <input type="text" id="campTracking" name="campTracking"
                style="max-width: 350px; margin-bottom: 15px!important;">
            <button onclick="copyIt()" id="btnCopy">Copy Tracking Link</button>
        </div>
    </div>
    <div style="width: 950px; margin: auto;">
        <img src="img/utm-parameters.png" style="width:950px;">
    </div>

    <script>

        function getProgram(program) {
            document.getElementById('utmcampProgram').innerText = program.value;
        }
        function getSource(source) {
            document.getElementById('utmcampSource').innerText = source.value;
        }
        function getMedium(medium) {
            document.getElementById('utmcampMedium').innerText = medium.value;
        }

        function getDate(date) {
            document.getElementById('utmcampDate').innerText = date.value;
        }
        function getSubject(subject) {
            document.getElementById('utmcampSubject').innerText = subject.value.replace(/[.,\/#!$%\^&\*"'’;:<>@?{}=\-_`~()]/g, "").replace(/ /g, '+').toLowerCase();
        }

        function getUrl(url) {
            var link = url.value;
            if (link.includes('?')) {
                document.getElementById('utmcampQuery').innerText = "&";
            }
            else {
                document.getElementById('utmcampQuery').innerText = "?";
            }

            if (link.includes('#')) {
                var anchor = "#" + link.slice(link.indexOf('#') + 1);
                document.getElementById('utmAnchor').innerText = anchor;
            }
            else {
                document.getElementById('utmAnchor').innerText = "";
            }
        }

        function getEblink(eb) {
            var answer = eb.value;
            if (answer == 'Yes') {
                document.getElementById('labelUrl').innerText = "Paste Eventbrite link with affiliate query";
            }
            else {
                document.getElementById('labelUrl').innerText = "Paste URL to be shared";
            }
        }

        function getTracking() {
            var program = document.getElementById('campProgram').value;
            var source = document.getElementById('campSource').value;
            var medium = document.getElementById('campMedium').value;
            var subject = document.getElementById('campSubject').value.replace(/[.,\/#!$%\^&\*"'’;:<>@?{}=\-_`~()]/g, "").replace(/ /g, '+').toLowerCase();
            var date = document.getElementById('campDate').value;
            var url = document.getElementById('campUrl').value;
            var utm = "utm_id=cstudies&utm_campaign=" + program + "&utm_source=" + source + "&utm_medium=" + medium + "&utm_content=" + program + "+" + date + "+" + subject;
            var output = "";

            // check if url contains a query string
            if (url.includes('?')) {
                // if yes, extend query string using &
                output = "&" + utm;
            }
            else {
                // if no, start a query string
                output = "?" + utm;
            }

            // check if url contains an anchor.
            if (url.includes('#')) {
                // append anchor tag to end
                output = output + "#" + url.split('#')[1];
            }

            document.getElementById('campTracking').value = output;
        }

        function getTrackingUrl() {
            var program = document.getElementById('campProgram').value;
            var source = document.getElementById('campSource').value;
            var medium = document.getElementById('campMedium').value;
            var subject = document.getElementById('campSubject').value.replace(/[.,\/#!$%\^&\*"'’;:<>@?{}=\-_`~()]/g, "").replace(/ /g, '+').toLowerCase();
            var date = document.getElementById('campDate').value;
            var url = document.getElementById('campUrl').value;
            var utm = "utm_id=cstudies&utm_campaign=" + program + "&utm_source=" + source + "&utm_medium=" + medium + "&utm_content=" + program + "+" + date + "+" + subject;
            var output = "";

            // check if url contains a query string
            if (url.includes('?')) {
                // if yes, extend query string using &
                output = "&" + utm;
            }
            else {
                // if no, start a query string
                output = "?" + utm;
            }

            // check if url contains an anchor.
            if (url.includes('#')) {
                // append anchor tag to end
                output = output + "#" + url.split('#')[1];
            }

            document.getElementById('campTracking').value = url.split('#')[0] + output;

        }

        function copyIt() {
            let copyutm = document.getElementById("campTracking");

            /* Select the text field */
            copyutm.select();

            /* Copy the text inside the text field */
            document.execCommand("copy");

            /* Use below command to access the 
            value of copied text */
            console.log(copyutm.value);
        }
    </script>
    <script src="index.js"></script>
</body>

</html>
